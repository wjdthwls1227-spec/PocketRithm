# 탈퇴 후 재가입 시 이메일 인증 문제 해결 가이드

## ❌ 문제: 탈퇴 후 재가입 시 인증 이메일이 오지 않음

탈퇴한 계정으로 재가입할 때 인증 이메일이 발송되지 않는 문제를 해결하는 방법입니다.

## 🔍 가능한 원인

1. **이메일 발송 제한 (Rate Limiting)**
   - 짧은 시간 내에 같은 이메일로 여러 번 요청
   - Supabase의 이메일 발송 제한에 걸림

2. **네이버 SMTP 설정 문제**
   - 네이버 SMTP가 제대로 설정되지 않음
   - 네이버 메일에서 SMTP 사용이 비활성화됨

3. **Supabase 프로젝트 상태**
   - 프로젝트가 일시정지(Paused) 상태
   - 이메일 발송 기능이 비활성화됨

4. **이메일 템플릿 오류**
   - 이메일 템플릿에 문법 오류
   - 필수 변수 누락

## 🚀 해결 방법

### 방법 1: 이메일 재발송 (가장 간단)

1. **회원가입 페이지에서**
   - 회원가입 완료 후 "이메일 다시 보내기" 버튼 클릭
   - 몇 분 기다린 후 다시 시도

2. **로그인 페이지에서**
   - 로그인 페이지로 이동
   - "인증 이메일 다시 보내기" 버튼 클릭

### 방법 2: Supabase 대시보드에서 확인

1. **Supabase 대시보드 접속**
   - https://supabase.com/dashboard
   - 프로젝트 선택

2. **Authentication → Users**
   - 재가입한 이메일로 사용자 검색
   - 사용자 클릭하여 상세 정보 확인

3. **이메일 확인 상태 확인**
   - "Email Confirmed" 상태 확인
   - 이미 확인된 경우: 로그인 시도
   - 확인되지 않은 경우: 수동으로 확인 처리 가능

4. **수동으로 이메일 확인 (개발용)**
   - 사용자 상세 페이지에서
   - "Email Confirmed" 체크박스 활성화
   - 저장
   - 이후 로그인 가능

### 방법 3: 이메일 인증 비활성화 (개발용)

개발 중이라면 이메일 인증을 임시로 비활성화할 수 있습니다:

1. **Supabase 대시보드**
   - Authentication → Providers → Email
   - "Confirm email" 옵션을 OFF로 변경
   - 저장

2. **재가입 시도**
   - 회원가입 후 바로 로그인 가능
   - 이메일 확인 불필요

### 방법 4: 네이버 SMTP 설정 확인

네이버 SMTP를 사용하는 경우:

1. **네이버 메일 설정 확인**
   - https://mail.naver.com 접속
   - 환경설정 → POP3/IMAP 설정
   - "POP3/SMTP 사용" 활성화 확인
   - "보안 메일(SMTP) 사용" 활성화 확인

2. **Supabase SMTP 설정 확인**
   - Authentication → Settings → SMTP Settings
   - 네이버 SMTP 정보 확인:
     - Host: `smtp.naver.com`
     - Port: `465` (SSL)
     - Username: 네이버 이메일
     - Password: 네이버 비밀번호 또는 앱 비밀번호

3. **2단계 인증 사용 시**
   - 네이버 계정 설정에서 앱 비밀번호 생성
   - 생성된 앱 비밀번호를 Supabase SMTP Password에 입력

### 방법 5: Supabase 프로젝트 상태 확인

1. **프로젝트 상태 확인**
   - Supabase 대시보드에서 프로젝트 상태 확인
   - "Paused" 상태인 경우 "Resume" 클릭

2. **프로젝트 재시작**
   - Settings → General
   - 프로젝트 재시작 (필요한 경우)

## 📧 이메일 발송 제한

Supabase 무료 플랜의 경우:
- **시간당 이메일 발송 제한**이 있을 수 있습니다
- 같은 이메일로 **짧은 시간 내 여러 번 요청**하면 제한에 걸릴 수 있습니다
- **해결**: 몇 분 기다린 후 다시 시도

## ✅ 체크리스트

재가입 시 이메일이 오지 않는 경우:

- [ ] 회원가입 완료 후 "이메일 다시 보내기" 버튼 클릭
- [ ] 몇 분 기다린 후 다시 시도
- [ ] Supabase 대시보드에서 사용자 상태 확인
- [ ] 네이버 SMTP 설정 확인 (네이버 SMTP 사용 시)
- [ ] Supabase 프로젝트 상태 확인
- [ ] 이메일 템플릿 확인 (Authentication → Email Templates)
- [ ] 브라우저 콘솔(F12)에서 오류 메시지 확인

## 💡 권장 사항

### 개발 환경
- 이메일 인증을 비활성화하여 빠르게 테스트
- 재가입 테스트 시 몇 분 간격으로 시도

### 프로덕션 환경
- 커스텀 SMTP 설정 (네이버, Gmail 등)
- 이메일 발송 모니터링
- Rate limiting 고려

## 🔄 재가입 시 주의사항

1. **탈퇴 후 즉시 재가입**
   - 이메일 발송 제한에 걸릴 수 있음
   - 몇 분 기다린 후 재가입 권장

2. **같은 이메일로 재가입**
   - Supabase에서 사용자 삭제 후 재가입 가능
   - 이메일 발송에 시간이 걸릴 수 있음

3. **이메일이 오지 않는 경우**
   - "이메일 다시 보내기" 버튼 사용
   - Supabase 대시보드에서 수동 확인 (개발용)


